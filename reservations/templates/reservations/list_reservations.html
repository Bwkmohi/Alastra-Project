{% extends 'reservations/base.html' %}

{% block res_content %}
{% load humanize %}
<title>لیست سفارشات</title>


<div class="space-y-4 max-w-5xl mx-auto">
  {% for i in reservations %}
    <div class="group bg-gradient-to-bl from-[#06244188] to-[#06244188] rounded-2xl p-6 border border-[#0bffff33] shadow-lg shadow-[#0bffff11] backdrop-blur-sm hover:border-[#0bffff] hover:shadow-[0_0_30px_rgba(11,255,255,0.3)] transition-all duration-500">

        <!-- هدر کارت -->
        <div class="flex items-center gap-4 mb-4">
            <div class="relative">
                <img src="{{ i.product.image.url }}" class="w-20 h-20 rounded-2xl {% if i.paid == False %}border border-[0.5px] border-red-300{% endif %} object-cover shadow-lg" />
                <div class="absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-br from-[#0bffff] to-[#0bffffee] rounded-full flex items-center justify-center">
                    <span class="text-[#062441] text-xs font-black">{{ i.quantity }}</span>
                </div>
            </div>
            <div class="flex-1">
                <h4 class="text-lg font-black text-white group-hover:text-[#0bffff] transition-colors">
                    {{ i.order.name }} {{ i.order.lastname }}
                </h4>
                <p class="text-[#0bffffaa] text-sm mt-1">{{ i.product.name }}</p>
                <div class="flex items-center gap-4 mt-2">
                    <span class="text-white font-bold text-lg">{{ i.totalprice|intcomma  }} <span class="text-[#0bffffaa] text-sm">تومان</span></span>
                    <span class="text-[#0bffffaa] text-sm">•</span>
                    <span class="text-[#0bffffaa] text-sm">{{ i.order.province.name }}/{{ i.order.city.name }}</span>
                </div>
            </div>
        </div>

        <!-- اطلاعات سفارش -->
        <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="flex items-center gap-3 p-3 rounded-xl bg-[#0b142133] border border-[0.2px] border-[#0bffffcc]">
                <div class="w-8 h-8 bg-gradient-to-br from-[#0bffff33] to-[#0bffff55] rounded-lg flex items-center justify-center">
                    <i class="bi bi-box text-sm text-[#0bffff]"></i>
                </div>
                <div>
                    <p class="text-[#0bffffaa] text-xs">تعداد</p>
                    <p class="text-white font-bold">{{ i.quantity }} عدد</p>
                </div>
            </div>
            
            <div class="flex items-center gap-3 p-3 rounded-xl bg-[#0b142133] border border-[0.2px] border-[#0bffffcc]">
                <div class="w-8 h-8 bg-gradient-to-br from-[#0bffff33] to-[#0bffff55] rounded-lg flex items-center justify-center">
                    <i class="bi bi-cash text-sm text-[#0bffff]"></i>
                </div>
                <div>
                    <p class="text-[#0bffffaa] text-xs">قیمت واحد</p>
                    <p class="text-white font-bold">{{ i.product.price|intcomma  }} تومان</p>
                </div>
            </div>
        </div>

        <!-- وضعیت‌های سفارش -->
        <div class="flex items-center gap-3 mb-4">
            {% if not i.is_sent and not i.delivered and not i.canceled %}
            <span class="bg-gradient-to-r from-[#ffa72633] to-[#ffa72611] border border-[#ffa72633] text-[#ffa726] px-3 py-1 rounded-full text-xs font-bold">
                 جدید
            </span>
            {% endif %}
            
            {% if i.is_sent and not i.delivered %}
            <span class="bg-gradient-to-r from-[#4ecdc433] to-[#4ecdc411] border border-[#4ecdc433] text-[#4ecdc4] px-3 py-1 rounded-full text-xs font-bold">
                 ارسال شده
            </span>
            {% endif %}
            
            {% if i.delivered %}
            <span class="bg-gradient-to-r from-[#66bb6a33] to-[#66bb6a11] border border-[#66bb6a33] text-[#66bb6a] px-3 py-1 rounded-full text-xs font-bold">
                 تحویل شده
            </span>
            {% endif %}
            
            {% if i.canceled or i.canceled %}
            <span class="bg-gradient-to-r from-[#ff6b6b33] to-[#ff6b6b11] border border-[#ff6b6b33] text-[#ff6b6b] px-3 py-1 rounded-full text-xs font-bold">
                 لغو شده
            </span>
            {% endif %}

            {% if i.paid == True %}
            <span class="bg-gradient-to-r from-[#66bb6a33] to-[#66bb6a11] border border-[#66bb6a33] text-[#66bb6a] px-3 py-1 rounded-full text-xs font-bold">
                 پرداخت شده
            </span>
            {% else %}
            <span class="bg-gradient-to-r from-[#ff6b6b33] to-[#ff6b6b11] border border-[#ff6b6b33] text-[#ff6b6b] px-3 py-1 rounded-full text-xs font-bold">
                 پرداخت نشده
            </span>
            {% endif %}
        </div>

        <!-- اقدامات -->
        <div class="flex items-center gap-3 pt-4 border-t border-[#0bffff33]">
            <a href="{% url 'res:order_detail' i.order.id %}" class="flex-1 py-2 text-center bg-gradient-to-r from-[#0bffff33] to-[#0bffff11] border border-[#0bffff44] text-[#0bffff] rounded-xl hover:border-[#0bffff] hover:shadow-[0_0_15px_rgba(11,255,255,0.3)] transition-all duration-300 font-medium text-sm">
                <i class="bi bi-eye ml-1"></i>
                جزئیات
            </a>
            
            {% if i.paid == True and i.canceled == False and i.delivered == False %}
            <a href="{% url 'res:cancel_order' i.id %}" onclick="return confirm('آیا مطمئن هستید؟')" class="flex-1 text-center py-2 bg-gradient-to-r from-[#ff6b6b33] to-[#ff6b6b11] border border-[#ff6b6b44] text-[#ff6b6b] rounded-xl hover:border-[#ff6b6b] hover:shadow-[0_0_15px_rgba(255,107,107,0.3)] transition-all duration-300 font-medium text-sm">
                <i class="bi bi-trash ml-1"></i>
                لغو سارش
            </a>
            {% endif %}           
        </div>

        <!-- اطلاعات کوچک -->
        <div class="flex items-center justify-between mt-3 pt-3 border-t border-[#0bffff33]">
            <span class="text-[#0bffffaa] text-xs">#{{ i.id }}</span>
            <span class="text-[#0bffffaa] text-xs">{{ i.order.created_at|date:"Y/m/d - H:i" }}</span>
        </div>
    </div>
    {% empty %}
        <div class="flex flex-col items-center justify-center text-center py-20 text-[#b0bfd1]">
            <svg class="w-20 h-20 mb-4 text-[#0bffffcc]" fill="none" stroke="currentColor" stroke-width="1.5"
                viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
                    d="M2.25 3h1.5l1.25 14.25a2.25 2.25 0 002.25 2.25h9a2.25 2.25 0 002.25-2.25L20.25 6H5.25" />
            <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 22a1 1 0 100-2 1 1 0 000 2zm6 0a1 1 0 100-2 1 1 0 000 2z" />
            </svg>
            <h2 class="text-2xl font-bold mb-2 text-white">سفارشی برای نمایش وجود ندارد</h2>
            <p class="text-sm">شما هنوز سفارشی ثبت نکرده‌اید یا همه سفارش‌ها تحویل داده شده‌اند.</p>
        </div>
    {% endfor %}
</div>
 

{% endblock %}
