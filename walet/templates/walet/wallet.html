{% extends 'walet/base.html' %}
{% block walet_con %}
{% load humanize %}
<title>
    کیف پول
</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap');

    
    .glass-effect {
        background: rgba(11, 20, 33, 0.8);
        backdrop-filter: blur(10px);
    }
    
    .neon-glow {
        box-shadow: 0 0 20px rgba(11, 255, 255, 0.4);
    }
    
    .transaction-card {
        transition: all 0.3s ease;
        border: 1px solid rgba(11, 255, 255, 0.2);
    }
    
    .transaction-card:hover {
        border-color: rgba(11, 255, 255, 0.5);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(11, 255, 255, 0.2);
    }
    
    .action-btn {
        transition: all 0.3s ease;
    }
    
    .action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(11, 255, 255, 0.3);
    }
    
    .pulse-animation {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
</style>

<section class="min-h-screen bg-[#0b1421] text-white font-semibold" dir="rtl">
    <div class="container mx-auto p-4 w-full max-w-6xl">
        <div class="bg-gradient-to-r from-[#062441] via-[#0b1421] to-[#0b1421] rounded-2xl p-6 shadow-2xl shadow-[#0bffffcc]/40 mb-6 text-center glass-effect neon-glow relative overflow-hidden">
            <div class="absolute -top-10 -right-10 w-20 h-20 bg-[#0bffff33] rounded-full blur-xl"></div>
            <div class="absolute -bottom-10 -left-10 w-24 h-24 bg-[#0bffff33] rounded-full blur-xl"></div>
            
            <button onclick="addBankCart.showModal()" class="action-btn bg-[#0bffffcc] text-[#0b1421] rounded-sm shadow-md hover:bg-[#0b1421] transition duration-300 flex flex-col items-center justify-center gap-2">
                <i class="bi bi-plus text-2xl"></i>
            </button>

            <div class="relative z-10">
                <p class="text-sm text-[#b0bfd1] mb-1">موجودی کل کیف پول</p>
                <p class="sm:text-4xl text-2xl font-bold drop-shadow pulse-animation">{{ balance|intcomma  }}<span class="text-2xl">تومان</span></p>
            </div>
        </div>
      
        <div class="grid grid-cols-3 gap-4 text-center mb-8">
            <button onclick="deposit.showModal()" class="action-btn bg-[#0bffffcc] text-[#0b1421] rounded-xl py-4 shadow-md hover:bg-[#0bffff] transition duration-300 flex flex-col items-center justify-center gap-2">
                <i class="bi bi-arrow-down-circle-fill text-2xl"></i>
                <span class="text-sm font-medium">واریز</span>
            </button>
            <button onclick="withdraw.showModal()" class="action-btn bg-[#0bffffcc] text-[#0b1421] rounded-xl py-4 shadow-md hover:bg-[#0bffff] transition duration-300 flex flex-col items-center justify-center gap-2">
                <i class="bi bi-arrow-up-circle-fill text-2xl"></i>
                <span class="text-sm font-medium">برداشت</span>
            </button>
            <button title="غیر فعال" class="action-btn bg-[#0bffffcc] text-[#0b1421] rounded-xl py-4 shadow-md hover:bg-[#0b1421] transition duration-300 flex flex-col items-center justify-center gap-2">
                <i class="bi bi-arrow-left-right text-2xl"></i>
                <span class="text-sm font-medium" title="غیر فعال">انتقال</span>
            </button>
        </div>

        <div class="flex justify-between items-center mb-4 px-2">
            <h2 class="text-lg font-bold text-[#0bffffcc]">تاریخچه تراکنش‌ها</h2>
        </div>

        <div class="space-y-3">
            {% for i in transactions %}
            <div class="transaction-card bg-gradient-to-l from-[#062441] to-[#0b1421] rounded-xl py-4 px-8">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="bg-[#0bffff22] p-2 rounded-lg">
                            {% if i.transaction_type == 'deposit' %}
                                <i class="bi bi-arrow-down-circle-fill text-[#0bffffcc] text-lg"></i>
                            {% elif i.transaction_type == 'withdraw' %}
                                <i class="bi bi-bi bi-check2-circle text-[#0bffffcc] text-lg"></i>
                            {% elif i.transaction_type == 'payment' %}
                                <i class="bi bi-arrow-left-right text-[#0bffffcc] text-lg"></i>
                            {% elif i.transaction_type == 'payment_by_others' %}
                                <i class="bi bi-arrow-left-right text-[#0bffffcc] text-lg"></i>
                            {% endif %}
                        </div>
                        <div>
                            <div class="font-medium">{{ i.description }}</div>
                            <div class="text-xs text-gray-400 mt-1">کد: {{ i.id }}</div>
                        </div>
                    </div>
                    
                    <div class="text-left">
                        <div class="text-[#0bffffcc] font-bold text-lg">{{ i.to_persian_amount_number }}<span class="text-xs">تومان</span></div>
                        <div class="flex items-center justify-end gap-2 mt-1">
                            <span class="text-xs text-gray-400">{{ i.time }}</span>
                            {% if i.status == True %}
                                <i class="bi bi-check2-circle text-green-500 text-sm"></i>
                            {% else %}
                                <i class="bi bi-x-circle text-red-500 text-sm"></i>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <dialog id="withdraw"
        class="bg-[#0b1421] text-white rounded-2xl p-6 w-full max-w-md shadow-2xl border border-[#0bffff55]">

        <h2 class="text-xl font-bold mb-4 text-center text-[#0bffff]">
            برداشت پول از کیف پول به حساب بانکی
        </h2>

        <form action="{% url 'withdraw_view' %}" method="POST">
            {% csrf_token %}
        <div class="mb-4">
            <label class="block text-sm mb-1 text-[#b0bfd1]">مبلغ (تومان)</label>
            <input type="number"
                    name="amount"
                class="w-full rounded-xl bg-[#061726] border border-[#0bffff33] p-3 text-white focus:outline-none focus:border-[#0bffff]"
                placeholder="">
        </div>

        <div class="mb-6">
            <label class="block text-sm mb-1 text-[#b0bfd1]">شماره کارت بانکی</label>
            <select name="" id="" class="w-full rounded-xl bg-[#061726] border border-[#0bffff33] p-3 text-white focus:outline-none focus:border-[#0bffff]">
                {% for i in bankCartNumber %}
                    <option value="{{ i.id }}">{{ i.number }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-[#0bffff] text-[#0b1421] rounded-xl py-3 font-semibold">
                برداشت 
            </button>

            <button onclick="withdraw.close()" type="button"
                    class="flex-1 bg-[#1a2636] rounded-xl py-3">
                انصراف
            </button>
        </div>
        </form>
    </dialog>

    <dialog id="deposit"
        class="bg-[#0b1421] text-white rounded-2xl p-6 w-full max-w-md shadow-2xl border border-[#0bffff55]">

        <h2 class="text-xl font-bold mb-4 text-center text-[#0bffff]">
            واریز به کیف پول
        </h2>

        <form action="{% url 'start_deposit_to_wallet' %}" method="POST">
            {% csrf_token %}
        <div class="mb-4">
            <label class="block text-sm mb-1 text-[#b0bfd1]">مبلغ (تومان)</label>
            <input type="number"
                    name="amount"
                class="w-full rounded-xl bg-[#061726] border border-[#0bffff33] p-3 text-white focus:outline-none focus:border-[#0bffff]"
                placeholder="">
        </div>

        <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-[#0bffff] text-[#0b1421] rounded-xl py-3 font-semibold">
                تایید 
            </button>

            <button type="button" onclick="deposit.close()"
                    class="flex-1 bg-[#1a2636] rounded-xl py-3">
                انصراف
            </button>
        </div>
        </form>
    </dialog>
    
    <dialog id="addBankCart"
        class="bg-[#0b1421] text-white rounded-2xl p-6 w-full max-w-md shadow-2xl border border-[#0bffff55]">

        <h2 class="text-xl font-bold mb-4 text-center text-[#0bffff]">
            افزودن شماره کارت
        </h2>

        <form action="{% url 'add_bank_cart_number' %}" method="POST">
            {% csrf_token %}
        <div class="mb-4">
            <label class="block text-sm mb-1 text-[#b0bfd1]">شماره کارت</label>
            <input type="number"
                    name="bank_cart_number"
                class="w-full rounded-xl bg-[#061726] border border-[#0bffff33] p-3 text-white focus:outline-none focus:border-[#0bffff]"
                placeholder="">
        </div>

        <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-[#0bffff] text-[#0b1421] rounded-xl py-3 font-semibold">
                ثبت
            </button>

            <button type="button" onclick="addBankCart.close()"
                    class="flex-1 bg-[#1a2636] rounded-xl py-3">
                انصراف
            </button>
        </div>
        </form>
    </dialog>
<style>
dialog::backdrop {
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
}
</style>
</section>
{% endblock %}