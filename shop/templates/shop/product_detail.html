{% extends 'shop/base.html' %}
{% block content_sh %}
  {% load static %}  
  {% load humanize %}
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ product.name }} | Ø®Ø±ÛŒØ¯ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¯Ø± {{ site_info.site_title }}</title>
  <meta name="description" content="{{ product.description_seo|default:product.description|default:product.name }}">
  <meta name="keywords" content="{{ product.tags.all|join:', ' }}">
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="{{ product.name }}" />
  <meta property="og:description" content="{{ product.description_seo|default:product.description|default:product.name }}" />
  <meta property="og:type" content="product" />
  <meta property="og:url" content="{{ request.build_absolute_uri }}" />
  <meta property="og:image" content="{{ product.image.url }}" />
 
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ product.name }}" />
  <meta name="twitter:description" content="{{ product.description_seo|default:product.description|default:product.name }}" />
  <meta name="twitter:image" content="{{ product.image.url }}" />

  <!-- Canonical -->
  <link rel="canonical" href="{{ request.build_absolute_uri }}" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Schema.org JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": "{{ product.name }}",
    "image": [
      "{{ product.image.url }}",
    ],
    "description": "{{ product.description|escapejs }}",
    "sku": "{{ product.slug }}",
    "brand": {
      "@type": "Brand",
      "name": "{{ product.brand }}"
    },
    "offers": {
      "@type": "Offer",
      "url": "{{ request.build_absolute_uri }}",
      "priceCurrency": "IRR",
      "price": "{{ product.price_|default:'ØªÙˆØ§ÙÙ‚ÛŒ' }}",
      "availability": "{% if product.qunat > 0 %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
      "itemCondition": "https://schema.org/NewCondition"
    }
  }
  </script>
</head>


<style>
  .no-scrollbar::-webkit-scrollbar {
  display: none;
}
.no-scrollbar {
  -ms-overflow-style: none;  /* IE Ùˆ Edge */
  scrollbar-width: none;     /* Firefox */
}
.fade {
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}
.fade-visible {
    opacity: 1;
}
.gradient-line {
    background: linear-gradient(90deg, #0bffffcc, #0077ff);
    box-shadow: 0px 0px 15px #0bffffcc;
}
  .scrollbar-hide::-webkit-scrollbar { display: none; }
  .snap-x { scroll-snap-type: x mandatory; }
  .snap-center { scroll-snap-align: center; }
  img { max-height: 240px; object-fit: cover; }
  dialog::backdrop { background: rgba(0,0,0,0.7); }
</style>

<style>

  #toggleButton {
    position: fixed;
    top: 10px;
    right: 10px;
    background: #062441;
    border: none;
    padding: 10px 15px;
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    z-index: 1200;
    transition: background-color 0.3s ease;
  }
  #toggleButton:hover {
    background: #0b1421;
  }

  /* Ù¾Ù†Ù„ */
  #slidePanel {
    position: fixed;
    top: 0;
    left: 50%;
    transform: translate(-50%, -100%) scale(0.95);
    width: 90vw;
    max-width: 900px;
    background: #0b1421;
    border-radius: 0 0 20px 20px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.7);
    opacity: 0;
    pointer-events: none;
    transition: transform 0.4s ease, opacity 0.4s ease;
    z-index: 1100;
  }
  /* ÙˆÙ‚ØªÛŒ Ø¨Ø§Ø² Ø´Ø¯ */
  #slidePanel.open {
    transform: translate(-50%, 0) scale(1);
    opacity: 1;
    pointer-events: auto;
  }

  #slidePanel .buttons-row button {
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }
</style>
  
<style>
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>

<style>
  .slide-panel {
    transition: transform 0.5s ease-in-out;
    transform: translateX(100%);
  }
  .slide-panel.open {
    transform: translateX(0%);
  }
</style>

 

<div class="p-4 bg-gradient-to-r from-[#062441] via-[#0b1421] to-[#0b1421]">
    <div class="flex sm:flex-row flex-col relative">
        <div class="md:w-1/2 w-full sm:p-4 sm:mx-2">
          <div class="overflow-hidden rounded-lg mb-2 shadow-2xl shadow-[#b0bfd1]/40">
              <img 
                src="{{ product.image.url }}"
                class="w-full hover:scale-105 transition-transform duration-300 cursor-pointer"
                onclick="openProductModal(0)"  
                alt="Ø®Ø±ÛŒØ¯ {{ product.name }} Ø¯Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {{ site_info.site_title }} Ø¨Ø§ Ø¨Ù‡ØªØ±ÛŒÙ† Ù‚ÛŒÙ…Øª">
          </div>
        </div>
        <div class="md:w-1/2 w-full" >
            <div class="mx-4" dir="rtl">
                <h1 class="sm:text-5xl text-4xl font-bold drop-shadow-md mb-4" >{{ product.name }}</h1>
                <div class="flex items-center gap-2 mb-4">
                    <span class="text-sm text-gray-600">(124 Ù†Ø¸Ø±)</span>
 
                    <div class="flex text-yellow-400">
                      {% if product.total_rates == 1 or product.total_rates == 1.5 or product.total_rates > 1 and product.total_rates < 2 %}
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>                   
                      {% elif product.total_rates == 2 or product.total_rates == 2.5 or product.total_rates > 2 and product.total_rates < 3 %}
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        {% elif product.total_rates == 3 or product.total_rates == 3.5 or product.total_rates > 3 and product.total_rates < 4 %}
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        {% elif product.total_rates == 4 or product.total_rates == 4.5 %}
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                        {% else %}
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                        {% endif %}
                    </div>
                </div>
                <p class="text-2xl text-[#ffff] font-extrabold mb-5">
                  {% if product.sell_price %}
                     <span class="line-through text-gray-400 text-sm">{{ product.price }}</span>
                     <span class="text-white">{{ product.sell_price }}</span>     
                     {% else %}
                     <span class="text-white">{{ product.price }}</span>             
                  {% endif %}
                   
                
                </p>  
                <div class="mt-4"> 
                  
                  <div class="absolute top-2 left-3">
                    {% if product.have == False %}
                      <p class="text-1xl text-white bg-red-700 py-3 px-4 rounded-sm">Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ ÙØ¹Ù„Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†Ù…ÛŒØ¨Ø§Ø´Ø¯</p>
                    {% endif %}
                    {% if product.qunat == 1 and product.have == True %}
                      <p class="text-1xl text-white bg-[#062441] py-2 px-4 rounded-lg border border-[#0bffff66]">ØªÙ†Ù‡Ø§ 1 Ø¹Ø¯Ø¯ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡</p>
                    {% endif %}
                    {% if product.qunat == 2 and product.have == True %}
                      <p class="text-1xl text-white bg-[#062441] py-2 px-4 rounded-lg border border-[#0bffff66]">ØªÙ†Ù‡Ø§ 2 Ø¹Ø¯Ø¯ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡ </p>
                    {% endif %}

                  </div>
                    <h3 class="text-2xl font-bold mb-3 border-b border-[#062441] pb-1">ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø­ØµÙˆÙ„</h3>
 
                </div>     
                 <div class="mb-6" dir="rtl">
          
                  <button class="w-full flex justify-between items-center bg-[#0bffffcc] bg-opacity-30 rounded py-3 px-4 font-bold text-black mb-2" onclick="toggleAccordion('desc')">
                    ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø­ØµÙˆÙ„
                    <i id="icon-desc" class="bi bi-chevron-down"></i>
                  </button>
                  <div id="desc" class="hidden px-4 text-[#ffff] leading-relaxed">
                    {{ product.description }}
                  </div>
                </div>
                 <div class="mb-6">
                  <button class="w-[40%]  flex justify-between items-center border border-[#0bffffcc] bg-opacity-30 rounded py-3 px-4 font-bold text-[#ffff] mb-2" onclick="toggleAccordion('specs3')">
                    Ù…Ø´Ø®ØµØ§Øª ÙÙ†ÛŒ
                    <i id="icon-specs3" class="bi bi-chevron-down"></i>
                  </button>
                  <div id="specs3" class="hidden px-4 text-[#ffff]">
                    <ul class="space-y-2">
                      {% for i in product_details %}
                         <li>{{ i.key }} <i class="{{ i.key.icon }} mr-2"></i> : {{ i.value }}</li> 
                      {% endfor %}
                    </ul>
                  </div>
                </div>
            </div>
        </div>
    </div>
    <div class="bg-[#0b1421]">
        <div class="flex flex-row m-5 " dir="rtl">
            <div class="w-1/4">
                <span class="text-sm text-gray-300"><i class="bi bi-eye"></i> {{ product.views }} Ø¨Ø§Ø²Ø¯ÛŒØ¯</span>
            </div>
            <div class="w-1/4">
                 <button  id="like_btn" class="text-red-500" onclick="likeProduct({{ product.id }})" ondblclick="likeProduct({{ product.id }})" type="button"><i class="bi bi-heart-fill"></i> <span id="like_count"></span></button>
            </div>
            <div class="w-1/4">
                <div class="w-1/5"><button onclick="shareProduct()" class="text-white text-sm text-gray-300"><i class="bi bi-share-fill"></i></button></div>
           </div>
           <div class="w-1/4">
               <button><i class="bi bi-list-ul"></i></button>
            </div>
        </div>
        {% if product.shop %}
        <div class="w-full bg-gradient-to-r from-[#062441] relative border border-[#0bffffcc] via-[#0b1421] to-[#0b1421] rounded-2xl p-4 shadow-xl shadow-[#b0bfd1]/40 text-white flex flex-col sm:flex-row sm:items-start sm:justify-between transition-shadow duration-500 hover:shadow-[#b0bfd1]/60">
            <div class="flex flex-row items-center mb-4 sm:mb-0 ">
              <img
                src="{{ product.shop.logo.url }}"
                alt="Ù¾Ø±ÙˆÙØ§ÛŒÙ„ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {{ product.shop.name_shop }}"
                class="sm:w-20 sm:h-20 w-16 h-16 rounded-full border-2 border-[#0bffffcc] object-cover shadow-lg"
                loading="lazy"
              />
              <h3 class="md:text-2xl text-xl font-extrabold mr-4 drop-shadow"><a 
                href="{% url 'sellers:shop_public_page' product.shop.id %}"
                >{{ product.shop }}</a></h3>
                <form action="{% url 'follow:follow' %}" method="POST">
                  {% csrf_token %}
                  <input type="text" hidden name="url" value="/product/{{ product.id }}/{{ product.slug }}/">
                  <input type="text" hidden name="shop_id" value="{{ product.shop.id}}">
                  <button
                    type="submit"
                    class="bg-[#0bffffcc] hover:bg-[#0bffff66] absolute left-3 justify-center text-black font-semibold py-2 px-6 rounded-lg shadow-lg transition-colors duration-300"
                  >
                    {% if following_staff %}
                      Ø§Ù†ÙØ§Ù„Ùˆ
                    {% else %}
                      ÙØ§Ù„Ùˆ  
                    {% endif %}
                  </button>
                </form>
            </div>          
        </div>
          {% endif %}
    </div>
    <div class="bg-gradient-to-r from-[#062441] via-[#0bffffcc] to-[#0bffffcc] py-2 px-4 rounded-xl w-full shadow-2xl"></div>
     
</div>

<section class="bg-[#0b1421] py-8 px-4 md:px-8">
  <div class="max-w-7xl mx-auto flex flex-col md:flex-row gap-8 max-h-none md:max-h-[50vh]">
    
    <div class="w-full md:w-1/3 bg-gradient-to-br from-[#062441] via-[#0a1a2e] to-[#071927dd] p-6 rounded-2xl shadow-lg border border-[#0bffffcc]">
      <h2 class="text-3xl font-extrabold text-[#0bffffcc] mb-8 select-none">Ø«Ø¨Øª Ù†Ø¸Ø± Ø´Ù…Ø§</h2>
      <form method="POST" action="{% url 'comment_add' product.id %}">
        {% csrf_token %}
        <div class="mb-2">
          <label class="block text-sm font-bold text-[#0bffffcc] mb-2 select-none" for="message">Ù†Ø¸Ø± Ø´Ù…Ø§</label>
          <textarea 
            id="message"
            name="message" 
            rows="4" 
            required 
            class="w-full rounded-xl border-2 border-[#0bffffcc] bg-[#071927dd] px-5 py-3 text-white placeholder-[#84a9bb] resize-none focus:outline-none focus:ring-4 focus:ring-[#0bffffcc] transition duration-300"
            placeholder="Ù†Ø¸Ø± Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."></textarea>
        </div>

        <div class="mb-6">
          <span class="text-[#0bffffcc] font-bold select-none">Ø§Ù…ØªÛŒØ§Ø²:</span>
          <div class="flex items-center gap-2 mt-2" id="star-container">
            {% for i in "12345" %}
              <i class="bi bi-star-fill text-3xl cursor-pointer text-[#0bffffaa]" data-value="{{ forloop.counter }}"></i>
            {% endfor %}
          </div>
          <input type="hidden" name="rating" id="rating-input" value="5" />
        </div>

        <button 
          type="submit" 
          class="w-full py-3 mt-4 rounded-xl bg-[#0bffffcc] text-[#0b1421] font-extrabold hover:bg-[#0bffffee] active:scale-95 transition transform duration-300 shadow-md">
          Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø±
        </button>
      </form>
    </div>

    <div class="w-full md:w-2/3">
      <h2 class="section-title text-xl font-bold mt-10 mb-2 text-center mb-6 {% if not comments %} hidden md:block{% endif %}">Ù¾Ø±Ø³Ø´ Ù¾Ø§Ø³Ø® Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h2>

      <div class="space-y-6 no-scrollbar max-h-[40vh] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-[#0bffffcc]/60 scrollbar-track-[#071927dd]/40">
        {% for comment in comments %}
        <div class="bg-[#0b1421] p-6 rounded-xl shadow-md border border-[#0bffffcc]">
          <div class="flex items-center gap-3 mb-3">
            <img src="https://api.dicebear.com/7.x/initials/svg?seed={{ comment.user.username }}" alt="Ú©Ø§Ø±Ø¨Ø±" class="w-8 h-8 rounded-full border border-[#0bffffcc]" />
            <div class="flex flex-col flex-grow">
              <div class="flex justify-between items-center">
                <span class="text-[#0bffffcc] font-bold">{{ comment.user.get_full_name }}</span>
                <span class="text-xs text-[#84a9bb]">{{ comment.created_at|date:"Y/m/d H:i" }}</span>
              </div>
              <div class="flex items-center mt-1 space-x-1 rtl:space-x-reverse">
                {% for i in "12345" %}
                  {% if forloop.counter <= comment.rating %}
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.974a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.388 2.46a1 1 0 00-.364 1.118l1.287 3.974c.3.922-.755 1.688-1.54 1.118l-3.388-2.46a1 1 0 00-1.175 0l-3.388 2.46c-.784.57-1.838-.196-1.539-1.118l1.287-3.974a1 1 0 00-.364-1.118L2.046 9.4c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.974z"/></svg>
                  {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.974a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.388 2.46a1 1 0 00-.364 1.118l1.287 3.974c.3.922-.755 1.688-1.54 1.118l-3.388-2.46a1 1 0 00-1.175 0l-3.388 2.46c-.784.57-1.838-.196-1.539-1.118l1.287-3.974a1 1 0 00-.364-1.118L2.046 9.4c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.974z"/></svg>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          </div>
          <p class="text-[#a0c7d9] text-base leading-relaxed">{{ comment.message }}</p>
        </div>
        {% empty %}
        <p class="text-[#84a9bb] text-sm {% if not comments %} hidden md:block{% endif %}">Ù‡ÛŒÚ† Ù†Ø¸Ø±ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
        {% endfor %}
      </div>
    </div>

  </div>
</section>

<div id="productModal" class="fixed inset-0 bg-black/95 z-[9999] hidden items-center justify-center p-4">
  <div class="relative max-w-5xl w-full bg-[#0b1421] rounded-xl shadow-2xl">
     
    <button id="closeProductModalBtn" class="absolute top-3 left-3 z-10 text-white text-2xl hover:text-[#0bffff] transition">
      âœ•
    </button>

    <button id="prevProductBtn" class="absolute top-1/2 left-4 -translate-y-1/2 text-4xl text-[#0bffff] bg-black/50 rounded-full w-14 h-14 flex items-center justify-center cursor-pointer hover:bg-[#0bffff] hover:text-black transition z-50 select-none">
      â€¹
    </button>
    <button id="nextProductBtn" class="absolute top-1/2 right-4 -translate-y-1/2 text-4xl text-[#0bffff] bg-black/50 rounded-full w-14 h-14 flex items-center justify-center cursor-pointer hover:bg-[#0bffff] hover:text-black transition z-50 select-none">
      â€º
    </button>

    <img id="productModalImage" src="" alt="ØªØµÙˆÛŒØ± Ø¨Ø²Ø±Ú¯ Ù…Ø­ØµÙˆÙ„" class="w-full max-h-[70vh] object-contain rounded-xl mb-4" />
  </div>
</div>

 

<div class="fixed bottom-0 left-0 right-0 bg-[#0b1421] border-t border-gray-700 p-3 flex items-center justify-between z-50 flex-wrap gap-2">
    <div class="flex items-center gap-2">
      {% for i in cart %}
        {% if i.product.id == product.id %}
          <button class="w-8 h-8 rounded-full bg-[#b0bfd1] text-[#062441] text-xl font-bold" onclick="cartRemove()">âˆ’</button>
          <span class="font-bold text-lg" id="productQuantity">{{ i.quantity }}</span>
          <button class="w-8 h-8 rounded-full bg-[#b0bfd1] text-[#062441] text-xl font-bold" onclick="cartAdd()">+</button>
        {% endif %}
      {% endfor %}
    </div>
    <form action="{% url 'cart:cart_add' %}" class="flex-1" method="POST">
      {% csrf_token %}
      <input type="text" name="id" hidden class="hidden" value="{{ product.id }}" id="">
      <input type="text" name="qty" hidden class="hidden" value="1">  
      <input type="text" name="url" hidden class="hidden" value="{% url 'product_detail' product.id product.slug %}">

        <button class="w-full bg-[#0bffffcc] text-center text-[#ffff] py-3 rounded-lg font-bold shadow-md hover:bg-[#0bffff] transition">
           <i class="bi bi-cart-plus-fill"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ 
        </button>
   </form>
</div>
  
 
<!-- Ø­Ø¯ÛŒØ¯ ØªØ³Øª -->

<style>
/* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ú†Ø§Ø±Øª */
#priceChart {
    direction: ltr; /* Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ØµØ­ÛŒØ­ Ú†Ø§Ø±Øª */
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† hover Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø± */
.bg-\[\#071827\] {
    transition: all 0.3s ease;
}

.bg-\[\#071827\]:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(11, 255, 255, 0.15);
}

/* responsive adjustments */
@media (max-width: 768px) {
    #priceChart {
        height: 300px !important;
    }
    
    .grid-cols-2 {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 480px) {
    .grid-cols-2 {
        grid-template-columns: 1fr;
    }
}
</style>
<section class="bg-gradient-to-br from-[#0b1421] via-[#062441] to-[#0b1421] py-8 px-4 md:px-8 border-t border-[#0bffff33]">
    <div class="max-w-6xl mx-auto">
        <div class="bg-gradient-to-tr from-[#062441] via-[#0b1421] to-[#0b1421] rounded-3xl shadow-2xl border border-[#0bffff33] overflow-hidden">
            <!-- Ù‡Ø¯Ø± Ú†Ø§Ø±Øª -->
            <div class="p-6 border-b border-[#0bffff22]">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h2 class="text-2xl md:text-3xl font-extrabold text-[#0bffffcc] mb-2">
                            ğŸ“Š Ù†ÙˆØ³Ø§Ù† Ù‚ÛŒÙ…Øª Ø¯Ø± ÛŒÚ© Ø³Ø§Ù„ Ú¯Ø°Ø´ØªÙ‡
                        </h2>
                        <p class="text-[#b0bfd1] text-sm md:text-base">
                            Ø±ÙˆÙ†Ø¯ ØªØºÛŒÛŒØ±Ø§Øª Ù‚ÛŒÙ…Øª {{ product.name }} Ø§Ø² {{ one_year_ago|date:"Y/m/d" }} ØªØ§Ú©Ù†ÙˆÙ†
                        </p>
                    </div>
                    
                    <div class="flex items-center gap-4 bg-[#071827] rounded-2xl p-3 border border-[#0bffff33]">
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-[#0bffffcc] rounded-full"></div>
                            <span class="text-[#b0bfd1] text-sm">Ù‚ÛŒÙ…Øª Ø§ØµÙ„ÛŒ</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-[#ff6b6b] rounded-full"></div>
                            <span class="text-[#b0bfd1] text-sm">Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø¨Ø¯Ù†Ù‡ Ú†Ø§Ø±Øª -->
            <div class="p-6">
                <div class="bg-[#071827] rounded-2xl p-4 border border-[#0bffff22]">
                    <canvas id="priceChart" class="w-full h-80 md:h-96"></canvas>
                </div>
                
                <!-- Ø¢Ù…Ø§Ø± Ø®Ù„Ø§ØµÙ‡ -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
                    <div class="bg-[#071827] rounded-2xl p-4 border border-[#0bffff22] text-center">
                        <div class="text-[#b0bfd1] text-sm mb-1">Ú©Ù…ØªØ±ÛŒÙ† Ù‚ÛŒÙ…Øª</div>
                        <div class="text-[#0bffffcc] font-bold text-xl" id="minPrice">-</div>
                    </div>
                    <div class="bg-[#071827] rounded-2xl p-4 border border-[#0bffff22] text-center">
                        <div class="text-[#b0bfd1] text-sm mb-1">Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ù‚ÛŒÙ…Øª</div>
                        <div class="text-[#ff6b6b] font-bold text-xl" id="maxPrice">-</div>
                    </div>
                    <div class="bg-[#071827] rounded-2xl p-4 border border-[#0bffff22] text-center">
                        <div class="text-[#b0bfd1] text-sm mb-1">ØªØºÛŒÛŒØ±Ø§Øª</div>
                        <div class="text-[#b0bfd1] font-bold text-xl" id="priceChange">-</div>
                    </div>
                    <div class="bg-[#071827] rounded-2xl p-4 border border-[#0bffff22] text-center">
                        <div class="text-[#b0bfd1] text-sm mb-1">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†</div>
                        <div class="text-[#b0bfd1] font-bold text-xl" id="avgPrice">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const priceData = {{ price_history_json|safe }};
    
    if (priceData.labels.length > 0) {
        initializePriceChart(priceData);
    } else {
        document.querySelector('#priceChart').closest('section').innerHTML = `
            <div class="text-center py-12">
                <div class="text-6xl mb-4">ğŸ“ˆ</div>
                <h3 class="text-xl text-[#b0bfd1] mb-2">ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù‚ÛŒÙ…Øª Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</h3>
                <p class="text-[#b0bfd1]">Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØ³Ø§Ù† Ù‚ÛŒÙ…Øª Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
            </div>
        `;
    }
});

function initializePriceChart(data) {
    const ctx = document.getElementById('priceChart').getContext('2d');
    
    // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¢Ù…Ø§Ø±
    const prices = data.prices.filter(price => price !== null);
    const sellPrices = data.sell_prices.filter(price => price !== null && price !== undefined);
    
    const minPrice = Math.min(...prices);
    const maxPrice = Math.max(...prices);
    const avgPrice = (prices.reduce((a, b) => a + b, 0) / prices.length).toFixed(0);
    const priceChange = ((prices[prices.length - 1] - prices[0]) / prices[0] * 100).toFixed(1);
    
    // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
    document.getElementById('minPrice').textContent = minPrice.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
    document.getElementById('maxPrice').textContent = maxPrice.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
    document.getElementById('avgPrice').textContent = avgPrice.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
    document.getElementById('priceChange').textContent = 
        priceChange >= 0 ? `+${priceChange}%` : `${priceChange}%`;
    
    // Ø§ÛŒØ¬Ø§Ø¯ Ú†Ø§Ø±Øª
    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Ù‚ÛŒÙ…Øª Ø§ØµÙ„ÛŒ',
                    data: data.prices,
                    borderColor: '#0bffffcc',
                    backgroundColor: 'rgba(11, 255, 255, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#0bffffcc',
                    pointBorderColor: '#0b1421',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                },
                {
                    label: 'Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´',
                    data: data.sell_prices,
                    borderColor: '#ff6b6b',
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    borderDash: [5, 5],
                    pointBackgroundColor: '#ff6b6b',
                    pointBorderColor: '#0b1421',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                intersect: false,
                mode: 'index'
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: 'rgba(11, 20, 33, 0.9)',
                    titleColor: '#0bffffcc',
                    bodyColor: '#b0bfd1',
                    borderColor: '#0bffff33',
                    borderWidth: 1,
                    padding: 12,
                    rtl: true,
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
                            }
                            return label;
                        }
                    }
                }
            },
            scales: {
                x: {
                    grid: {
                        color: 'rgba(11, 255, 255, 0.1)'
                    },
                    ticks: {
                        color: '#b0bfd1',
                        maxTicksLimit: 6
                    }
                },
                y: {
                    grid: {
                        color: 'rgba(11, 255, 255, 0.1)'
                    },
                    ticks: {
                        color: '#b0bfd1',
                        callback: function(value) {
                            return value.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
                        }
                    }
                }
            }
        }
    });
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† event Ø¨Ø±Ø§ÛŒ responsive
    window.addEventListener('resize', function() {
        chart.resize();
    });
}
</script>

<!-- ================= -->

<!-- Ú¯Ø§Ù„Ø±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª -->
<section class="bg-gradient-to-br from-[#0b1421] via-[#062441] to-[#0b1421] py-12 px-4 md:px-8">
    <div class="max-w-7xl mx-auto">
        <!-- Ù‡Ø¯Ø± Ú¯Ø§Ù„Ø±ÛŒ -->
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-extrabold text-[#0bffffcc] mb-4 drop-shadow-lg">
                ğŸ¨ Ú¯Ø§Ù„Ø±ÛŒ Ù…Ø­ØµÙˆÙ„
            </h2>
            <p class="text-[#b0bfd1] text-lg max-w-2xl mx-auto leading-relaxed">
                ØªØµØ§ÙˆÛŒØ± Ø¨Ø§ Ú©ÛŒÙÛŒØª Ø§Ø² Ø²ÙˆØ§ÛŒØ§ÛŒ Ù…Ø®ØªÙ„Ù {{ product.name }} - Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø± Ø³Ø§ÛŒØ² Ø¨Ø²Ø±Ú¯ Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
            </p>
        </div>

        <!-- Ú¯Ø§Ù„Ø±ÛŒ Ø§ØµÙ„ÛŒ -->
        <div class="bg-gradient-to-tr from-[#062441] via-[#0b1421] to-[#0b1421] rounded-3xl shadow-2xl border border-[#0bffff33] overflow-hidden p-6">
            <!-- ØªØµÙˆÛŒØ± Ø§ØµÙ„ÛŒ -->
            <div class="mb-6">
                <div class="relative rounded-2xl overflow-hidden border-2 border-[#0bffff33] shadow-lg">
                    <img 
                        id="mainGalleryImage"
                        src="{{ product.image.url }}" 
                        alt="{{ product.name }}"
                        class="w-full h-64 md:h-96 object-cover cursor-zoom-in transition-transform duration-500 hover:scale-105"
                    >
                    <div class="absolute top-4 left-4 bg-[#0bffffcc] text-[#0b1421] px-3 py-1 rounded-full text-sm font-bold shadow-lg">
                        ØªØµÙˆÛŒØ± Ø§ØµÙ„ÛŒ
                    </div>
                </div>
            </div>

            <!-- ØªØµØ§ÙˆÛŒØ± Ú©ÙˆÚ†Ú© -->
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                <!-- ØªØµÙˆÛŒØ± Ø§ØµÙ„ÛŒ Ø¯Ø± Ú¯Ø§Ù„Ø±ÛŒ Ú©ÙˆÚ†Ú© -->
                <div class="group relative">
                    <img 
                        src="{{ product.image.url }}" 
                        alt="{{ product.name }}"
                        loading="lazy"
                        class="w-full h-24 md:h-32 object-cover rounded-xl border-2 border-[#0bffffcc] cursor-pointer shadow-lg transition-all duration-300 group-hover:scale-110 group-hover:shadow-2xl group-hover:shadow-[#0bffffcc]/50"
                    >
                    <div class="absolute inset-0 bg-[#0bffffcc] opacity-0 group-hover:opacity-20 rounded-xl transition-opacity duration-300"></div>
                </div>

                  {% for image in gallery %}
                    <div class="relative w-full aspect-[4/3] overflow-hidden rounded-xl shadow-lg cursor-pointer group"
                        onclick="openModal('{{ image.image.url }}', 'ØªÙˆØ¶ÛŒØ­ ØªØµÙˆÛŒØ±')">
                      <img src="{{ image.image.url }}" alt="{{ image.gallery_product.product.name }}" loading="lazy"
                          class="absolute inset-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" />
                    </div>
                  {% endfor %}
                </div>

            <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯Ø§Ù„Ø±ÛŒ -->
            <div class="mt-6 flex flex-wrap gap-4 justify-center text-[#b0bfd1] text-sm">
                <div class="flex items-center gap-2 bg-[#071827] px-4 py-2 rounded-2xl border border-[#0bffff22]">
                    <i class="bi bi-images text-[#0bffffcc]"></i>
                   <a href="{% url 'gallery:product_gallery' product.id %}"><span> Ù…Ø´Ø§Ù‡Ø¯Ù‡ <span class="text-[#0bffffcc] font-bold"><i class="bi bi-image"></i></span></span></a> 
                </div>
            </div>
        </div>
    </div>
</section>



<style>
/* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú¯Ø§Ù„Ø±ÛŒ */
.scrollbar-thin::-webkit-scrollbar {
    height: 6px;
}

.scrollbar-thin::-webkit-scrollbar-track {
    background: #071827;
    border-radius: 10px;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
    background: #0bffffcc;
    border-radius: 10px;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: #0bffff;
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ú¯Ø§Ù„Ø±ÛŒ */
@keyframes fadeIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

#galleryModal {
    animation: fadeIn 0.3s ease-out;
}

/* Ù‡Ø§ÛŒÙ„Ø§ÛŒØª ØªØµÙˆÛŒØ± ÙØ¹Ø§Ù„ */
.gallery-thumbnail-active {
    box-shadow: 0 0 0 3px #0bffffcc, 0 0 20px rgba(11, 255, 255, 0.5);
}

/* responsive */
@media (max-width: 768px) {
    #galleryModal .flex.gap-2 {
        padding-bottom: 8px;
    }
    
    #galleryModal .flex.gap-2 img {
        width: 50px;
        height: 50px;
    }
}
</style>
<!--  -->
 
<!-- Ú¯Ø§Ù„Ø±ÛŒ ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„ -->
<section class="bg-gradient-to-br from-[#0b1421] via-[#062441] to-[#0b1421] py-12 px-4 md:px-8 border-t border-[#0bffff33]">
    <div class="max-w-7xl mx-auto">
        <!-- Ù‡Ø¯Ø± ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ -->
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-extrabold text-[#0bffffcc] mb-4 drop-shadow-lg">
                ğŸ¬ ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„
            </h2>
            <p class="text-[#b0bfd1] text-lg max-w-2xl mx-auto leading-relaxed">
                ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒØŒ Ø¢Ù…ÙˆØ²Ø´ Ùˆ Ù…Ø¹Ø±ÙÛŒ {{ product.name }} - Ø¨Ø±Ø§ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ø¨Ù‡ØªØ± Ø®Ø±ÛŒØ¯
            </p>
        </div>

        <!-- Ú¯Ø§Ù„Ø±ÛŒ ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ -->
        <div class="bg-gradient-to-tr from-[#062441] via-[#0b1421] to-[#0b1421] rounded-3xl shadow-2xl border border-[#0bffff33] overflow-hidden p-6">
            <!-- Ù¾Ù„ÛŒØ± Ø§ØµÙ„ÛŒ -->
            <div class="mb-8">
                <div class="relative rounded-2xl overflow-hidden border-2 border-[#0bffff33] shadow-2xl bg-black">
                    <div id="mainVideoPlayer" class="w-full aspect-video bg-gradient-to-br from-[#062441] to-[#0b1421] flex items-center justify-center">
                        <div class="text-center">
                            <i class="bi bi-play-circle-fill text-6xl md:text-8xl text-[#0bffffcc] mb-4 opacity-80"></i>
                            <p class="text-[#b0bfd1] text-lg">Ø¨Ø±Ø§ÛŒ Ù¾Ø®Ø´ ÙˆÛŒØ¯ÛŒÙˆ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</p>
                        </div>
                    </div>
                    
                    <div class="absolute top-4 left-4 bg-[#0bffffcc] text-[#0b1421] px-3 py-1 rounded-full text-sm font-bold shadow-lg z-10">
                        ÙˆÛŒØ¯ÛŒÙˆÛŒ Ù…Ù†ØªØ®Ø¨
                    </div>
                    
                    <!-- Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù¾Ù„ÛŒØ± -->
                    <div class="absolute bottom-4 left-4 right-4 bg-gradient-to-t from-black/80 to-transparent p-4 opacity-0 transition-opacity duration-300" id="videoControls">
                        <div class="flex items-center gap-4">
                            <button onclick="togglePlayPause()" class="text-white text-2xl hover:text-[#0bffffcc] transition">
                                <i class="bi bi-pause-fill" id="playPauseIcon"></i>
                            </button>
                            <div class="flex-1 bg-[#b0bfd1]/30 rounded-full h-2">
                                <div class="bg-[#0bffffcc] h-2 rounded-full w-0" id="progressBar"></div>
                            </div>
                            <span class="text-white text-sm" id="timeDisplay">0:00 / 0:00</span>
                            <button onclick="toggleMute()" class="text-white text-xl hover:text-[#0bffffcc] transition">
                                <i class="bi bi-volume-up-fill" id="volumeIcon"></i>
                            </button>
                            <button onclick="toggleFullscreen()" class="text-white text-xl hover:text-[#0bffffcc] transition">
                                <i class="bi bi-arrows-fullscreen"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆÛŒØ¯ÛŒÙˆÛŒ ÙØ¹Ù„ÛŒ -->
                <div class="mt-4 p-4 bg-[#071827] rounded-2xl border border-[#0bffff22]">
                    <h3 id="currentVideoTitle" class="text-xl font-bold text-[#0bffffcc] mb-2">Ø¹Ù†ÙˆØ§Ù† ÙˆÛŒØ¯ÛŒÙˆ</h3>
                    <div class="flex items-center gap-4 mt-3 text-xs text-[#b0bfd1]">
                        <span><i class="bi bi-clock"></i> <span id="videoDuration">0:00</span></span>
                        <span><i class="bi bi-calendar"></i> <span id="videoDate">-</span></span>
                    </div>
                </div>
            </div>

            <!-- Ù„ÛŒØ³Øª ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

              {% for i in videos %}
                <div class="video-item group bg-[#071827] rounded-2xl border-2 border-[#0bffff33] overflow-hidden shadow-lg cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-[#0bffffcc]/30 hover:border-[#0bffffcc]"
                     data-video-src="{{i.video_file.url}}"
                     data-video-title="{{ i.title }}"
                     data-video-date="{{ i.created_at }}">
                    <div class="relative">
                        <div class="aspect-video bg-gradient-to-br from-[#062441] to-[#0b1421] flex items-center justify-center">
                            <i class="bi bi-play-circle-fill text-4xl text-[#0bffffcc] group-hover:scale-110 transition-transform duration-300"></i>
                        </div>
                        <div class="absolute bottom-2 left-2 bg-black/70 text-white text-xs px-2 py-1 rounded">
                            -:00
                        </div>
                    </div>
                    <div class="p-4">
                        <h4 class="font-bold text-white mb-2 line-clamp-2">{{ i.title }}</h4>
                        <p class="text-[#b0bfd1] text-xs line-clamp-2 mb-3">Ø¢Ù†Ø§Ù„ÛŒØ² Ø¯Ù‚ÛŒÙ‚ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…Ø­ØµÙˆÙ„ Ø¯Ø± Ø´Ø±Ø§ÛŒØ· Ù…Ø®ØªÙ„Ù</p>
                        <div class="flex justify-between items-center text-xs text-[#b0bfd1]">
                            <span>{{ i.created_at }}</span>
                        </div>
                    </div>
                </div>
              {% endfor %}
            </div>

            <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¢Ù…Ø§Ø±ÛŒ -->
            <div class="mt-8 flex flex-wrap gap-4 justify-center text-[#b0bfd1] text-sm">
                <div class="flex items-center gap-2 bg-[#071827] px-4 py-2 rounded-2xl border border-[#0bffff22]">
                    <i class="bi bi-play-btn text-[#0bffffcc]"></i>
                    <span>ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§: <span class="text-[#0bffffcc] font-bold">{{ len_videos }}</span></span>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
// Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆ Ù¾Ù„ÛŒØ±
let currentVideo = null;
let isPlaying = false;
let isMuted = false;
let updateInterval;

// Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ÙˆÛŒØ¯ÛŒÙˆ Ù¾Ù„ÛŒØ±
function initializeVideoPlayer() {
    const videoItems = document.querySelectorAll('.video-item');
    
    videoItems.forEach(item => {
        item.addEventListener('click', function() {
            const videoSrc = this.getAttribute('data-video-src');
            const videoTitle = this.getAttribute('data-video-title');
            const videoDate = this.getAttribute('data-video-date');
            
            loadVideo(videoSrc, videoTitle, videoDate);
            
            // Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ú©Ø±Ø¯Ù† ÙˆÛŒØ¯ÛŒÙˆÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
            videoItems.forEach(v => v.classList.remove('border-[#0bffffcc]'));
            this.classList.add('border-[#0bffffcc]');
        });
    });
    
    // Ù„ÙˆØ¯ Ø§ÙˆÙ„ÛŒÙ† ÙˆÛŒØ¯ÛŒÙˆ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
    const firstVideo = document.querySelector('.video-item');
    if (firstVideo) {
        firstVideo.click();
    }
}

// Ù„ÙˆØ¯ ÙˆÛŒØ¯ÛŒÙˆ
function loadVideo(src, title, date) {
    const videoContainer = document.getElementById('mainVideoPlayer');
    
    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙˆÛŒØ¯ÛŒÙˆÛŒ Ù‚Ø¨Ù„ÛŒ
    if (currentVideo) {
        currentVideo.remove();
        clearInterval(updateInterval);
    }
    
    // Ø§ÛŒØ¬Ø§Ø¯ Ø§Ù„Ù…Ù†Øª ÙˆÛŒØ¯ÛŒÙˆ
    currentVideo = document.createElement('video');
    currentVideo.src = src;
    currentVideo.className = 'w-full h-full object-cover';
    currentVideo.controls = false;
    currentVideo.muted = isMuted;
    
    // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆ
    currentVideo.addEventListener('loadedmetadata', function() {
        updateVideoInfo(title, date);
        setupVideoControls();
    });
    
    currentVideo.addEventListener('click', togglePlayPause);
    currentVideo.addEventListener('play', function() {
        isPlaying = true;
        updatePlayPauseIcon();
        showControls();
    });
    
    currentVideo.addEventListener('pause', function() {
        isPlaying = false;
        updatePlayPauseIcon();
    });
    
    currentVideo.addEventListener('ended', function() {
        isPlaying = false;
        updatePlayPauseIcon();
    });
    
    videoContainer.innerHTML = '';
    videoContainer.appendChild(currentVideo);
    
    // Ù†Ù…Ø§ÛŒØ´ Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ Ø±ÙˆÛŒ Ù‡Ø§ÙˆØ±
    videoContainer.addEventListener('mouseenter', showControls);
    videoContainer.addEventListener('mouseleave', hideControls);
}

// Ø¢Ù¾Ø¯ÛŒØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆÛŒØ¯ÛŒÙˆ
function updateVideoInfo(title, description, duration, views, date) {
    document.getElementById('currentVideoTitle').textContent = title;
    document.getElementById('videoDate').textContent = date;
}

// ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆ
function setupVideoControls() {
    updateInterval = setInterval(updateProgress, 1000);
}

// Ø¢Ù¾Ø¯ÛŒØª Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª
function updateProgress() {
    if (!currentVideo) return;
    
    const progressBar = document.getElementById('progressBar');
    const timeDisplay = document.getElementById('timeDisplay');
    
    if (currentVideo.duration) {
        const progress = (currentVideo.currentTime / currentVideo.duration) * 100;
        progressBar.style.width = `${progress}%`;
        
        const currentTime = formatTime(currentVideo.currentTime);
        const duration = formatTime(currentVideo.duration);
        timeDisplay.textContent = `${currentTime} / ${duration}`;
    }
}

// ÙØ±Ù…Øª Ø²Ù…Ø§Ù†
function formatTime(seconds) {
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${mins}:${secs.toString().padStart(2, '0')}`;
}

// Ú©Ù†ØªØ±Ù„ Ù¾Ù„ÛŒ/Ù¾Ø§Ø²
function togglePlayPause() {
    if (!currentVideo) return;
    
    if (isPlaying) {
        currentVideo.pause();
    } else {
        currentVideo.play();
    }
}

// Ø¢Ù¾Ø¯ÛŒØª Ø¢ÛŒÚ©ÙˆÙ† Ù¾Ù„ÛŒ/Ù¾Ø§Ø²
function updatePlayPauseIcon() {
    const icon = document.getElementById('playPauseIcon');
    icon.className = isPlaying ? 'bi bi-pause-fill' : 'bi bi-play-fill';
}

// Ú©Ù†ØªØ±Ù„ ØµØ¯Ø§
function toggleMute() {
    if (!currentVideo) return;
    
    isMuted = !isMuted;
    currentVideo.muted = isMuted;
    
    const volumeIcon = document.getElementById('volumeIcon');
    volumeIcon.className = isMuted ? 'bi bi-volume-mute-fill' : 'bi bi-volume-up-fill';
}

// ÙÙˆÙ„â€ŒØ§Ø³Ú©Ø±ÛŒÙ†
function toggleFullscreen() {
    if (!currentVideo) return;
    
    const videoContainer = document.getElementById('mainVideoPlayer');
    
    if (!document.fullscreenElement) {
        videoContainer.requestFullscreen().catch(err => {
            console.log(`Error attempting to enable fullscreen: ${err.message}`);
        });
    } else {
        document.exitFullscreen();
    }
}

// Ù†Ù…Ø§ÛŒØ´ Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§
function showControls() {
    const controls = document.getElementById('videoControls');
    controls.style.opacity = '1';
}

// Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§
function hideControls() {
    const controls = document.getElementById('videoControls');
    controls.style.opacity = '0';
}

// Ú©Ù†ØªØ±Ù„ Ø¨Ø§ Ú©ÛŒØ¨ÙˆØ±Ø¯
document.addEventListener('keydown', function(e) {
    if (!currentVideo) return;
    
    if (e.key === ' ') {
        e.preventDefault();
        togglePlayPause();
    } else if (e.key === 'm' || e.key === 'M') {
        toggleMute();
    } else if (e.key === 'f' || e.key === 'F') {
        toggleFullscreen();
    } else if (e.key === 'ArrowRight') {
        currentVideo.currentTime += 5;
    } else if (e.key === 'ArrowLeft') {
        currentVideo.currentTime -= 5;
    }
});

// Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
document.addEventListener('DOMContentLoaded', function() {
    initializeVideoPlayer();
});
</script>
<style>
/* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆ Ù¾Ù„ÛŒØ± */
.video-item {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* .video-item:hover {
    transform: translateY(-8px);
} */

.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆ */
#videoControls {
    background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 100%);
}

/* Ø§Ø³Ú©Ø±ÙˆÙ„bar Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
@media (max-width: 768px) {
    .video-item {
        margin-bottom: 1rem;
    }
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.bi-play-circle-fill {
    animation: pulse 2s infinite;
}

/* responsive video */
.aspect-video {
    aspect-ratio: 16 / 9;
}

/* Ø¨Ù‡Ø¨ÙˆØ¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
@media (max-width: 640px) {
    #mainVideoPlayer {
        border-radius: 1rem;
    }
    
    .video-item {
        border-width: 1px;
    }
}
</style>





<div id="galleryModal" class="fixed inset-0 bg-black/90 z-[9999] hidden items-center justify-center p-4">
  <div class="relative max-w-4xl w-full bg-[#0b1421] rounded-xl shadow-2xl p-4">
     
    <button id="closeModalBtn" class="absolute top-3 left-3 z-10 text-white text-2xl hover:text-[#0bffff] transition">
      âœ•
    </button>

    <button id="prevBtn" class="absolute top-1/2 left-4 -translate-y-1/2 text-4xl text-[#0bffff] bg-black/50 rounded-full w-14 h-14 flex items-center justify-center cursor-pointer hover:bg-[#0bffff] hover:text-black transition z-50 select-none">
      â€¹
    </button>
    <button id="nextBtn" class="absolute top-1/2 right-4 -translate-y-1/2 text-4xl text-[#0bffff] bg-black/50 rounded-full w-14 h-14 flex items-center justify-center cursor-pointer hover:bg-[#0bffff] hover:text-black transition z-50 select-none">
      â€º
    </button>


    <img id="modalImage" src="" alt="ØªØµÙˆÛŒØ± Ø¨Ø²Ø±Ú¯" class="w-full max-h-[70vh] object-contain rounded-xl mb-4" />
     
    <p id="modalCaption" class="text-[#b0bfd1] text-center text-sm md:text-base"></p>
 
<div class="text-center mt-4">

</div>    
  </div>
</div>


<style>
  /* Ø³Ø¨Ú© ØªØ§ÛŒØªÙ„ */
.section-title {
    font-size: 2.5rem;
    font-weight: bold;
    color: #0bffffee;
    position: relative;
    text-transform: uppercase;
    letter-spacing: 2px;
    padding-bottom: 10px;
    display: inline-block;
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù…ØªØ­Ø±Ú© Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒØªÙ„ */
.section-title::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(135deg, #062441, #0bffffcc);
    animation: lineMove 2s ease-in-out infinite;
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø­Ø±Ú©Øª Ø®Ø· Ù¾Ø§ÛŒÛŒÙ† ØªØ§ÛŒØªÙ„ */
@keyframes lineMove {
    0% {
        transform: scaleX(0);
        transform-origin: bottom right;
    }
    50% {
        transform: scaleX(1);
        transform-origin: bottom left;
    }
    100% {
        transform: scaleX(0);
        transform-origin: bottom right;
    }
}

/* Ø§ÙÚ©Øª Ù‡Ø§Ù„Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒØªÙ„ */
.section-title:hover {
    color: #fff;
    text-shadow: 0 0 15px rgba(11, 255, 255, 0.8);
    animation: glowEffect 1.5s ease-in-out infinite alternate;
}

/* Ø§ÙÚ©Øª Ù‡Ø§Ù„Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒØªÙ„ */
@keyframes glowEffect {
    0% {
        text-shadow: 0 0 10px rgba(11, 255, 255, 0.6), 0 0 20px rgba(11, 255, 255, 0.4);
    }
    100% {
        text-shadow: 0 0 20px rgba(11, 255, 255, 0.9), 0 0 30px rgba(11, 255, 255, 0.8);
    }
}

</style>


<div class="mt-12 max-w-4xl mx-auto rtl">
  <h2 class="section-title text-xl font-bold mt-10 mb-2 text-center mb-5">Ù¾Ø±Ø³Ø´ Ù¾Ø§Ø³Ø® Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h2>
  <!-- <h2 class="text-2xl font-bold mb-4 text-white border-b border-[#0bffffcc] pb-2">Ù¾Ø±Ø³Ø´ Ùˆ Ù¾Ø§Ø³Ø® Ù…Ø­ØµÙˆÙ„</h2> -->
  <div class="flex space-x-6 overflow-x-auto py-4 px-2 scrollbar-thin scrollbar-thumb-[#0bffffcc] scrollbar-track-[#062441]">

 
    <!-- Ú©Ø§Ø±Øª Ø¯ÙˆÙ… -->
     {% for i in responses %}
    <div class="min-w-[280px] mx-2 bg-gradient-to-br from-[#062441cc] to-[#0b1421cc] border-[0.3px] border-[#0bffffcc] rounded-2xl p-5 shadow-lg shadow-[#0bffff44] hover:scale-105 transform transition-transform duration-300 ease-in-out flex-shrink-0 relative">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[#0bffffcc] absolute top-4 left-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 14h.01M16 10h.01M12 18h.01" />
      </svg>

      <div class="flex items-center mb-2 pr-8">
        <img src="https://randomuser.me/api/portraits/men/44.jpg" alt="" class="w-9 h-9 rounded-full border-2 border-[#0bffffcc] ml-2" />
        <p class="font-bold text-[#0bffffee] truncate">{% if i.reply_ques.show_name %}{{ i.reply_ques.user.get_full_name }}{% else %}Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³{% endif %}</p>
      </div>

      <p class="mb-4 text-[#ffffffcc] leading-relaxed">{{ i.reply_ques.text }}</p>

      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[#0bffffcc] inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2M7 8H5a2 2 0 00-2 2v6a2 2 0 002 2h2m0-10v12a2 2 0 002 2h6a2 2 0 002-2V8H7z" />
      </svg>
      <span class="font-semibold text-[#0bffffcc]">Ù¾Ø§Ø³Ø® ÙØ±ÙˆØ´Ù†Ø¯Ù‡:</span>
      <p class="text-white mt-1 truncate">{{ i.response_text }}</p>
    </div>
    {% endfor %}
 

    <div onclick="openQuestionModal()" class="min-w-[280px] max-w-full bg-[#0bffff11] border border-dashed border-[#0bffff88] rounded-2xl p-5 shadow-md hover:scale-105 transform transition-transform duration-300 ease-in-out flex-shrink-0 flex items-center justify-center cursor-pointer">
      <div class="text-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-10 w-10 text-[#0bffffcc] mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
        </svg>
        <p class="text-sm text-white font-semibold">Ø§ÙØ²ÙˆØ¯Ù† Ø³ÙˆØ§Ù„ Ø¬Ø¯ÛŒØ¯</p>
      </div>
    </div>
  </div>
</div>


<div id="questionModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
  <div class="bg-[#0b1421] border border-[#0bffffcc] rounded-xl px-4 py-10 md:p-10 max-w-2xl w-full mx-4 shadow-lg relative">
    <button onclick="closeQuestionModal()" class="absolute top-3 right-3 text-[#0bffffcc] hover:text-[#0bffffee] text-2xl font-bold">&times;</button>
    <h3 class="text-[#0bffffcc] text-xl font-bold mb-4 text-center">Ø«Ø¨Øª Ø³ÙˆØ§Ù„ Ø¬Ø¯ÛŒØ¯</h3>
    <form action="{% url 'add_product_question' product.id %}" method="POST">
      {% csrf_token %}
    <textarea id="questionText" name="text" rows="5" required class="w-full p-3 rounded-lg bg-[#0bffff11] border border-[#0bffff88] text-white placeholder-[#0bffffaa] resize-none focus:outline-none focus:ring-2 focus:ring-cyan-400" placeholder="Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."></textarea>
      <div class="w-full mx-4 p-2">
        <label class="inline-flex items-center me-5 cursor-pointer">
            <input type="checkbox" class="sr-only peer" checked name='show_name' value="True">
            <div class="relative w-11 h-6 bg-[#0bffffcc] rounded-full peer dark:bg-[#0b1421] peer-focus:ring-4 peer-focus:ring-[#0bffffcc] dark:peer-focus:ring-teal-800 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:start-[2px] after:bg-white after:border-[#0bffffcc] after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-teal-600 dark:peer-checked:bg-teal-600"></div>
            <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù† Ù†Ø§Ù… </span>
        </label>
      </div> 
    <button class="mt-4 w-full bg-[#0bffffcc] text-[#0b1421] font-bold py-2 rounded-lg hover:bg-[#0bffffee] transition-colors"><i class="bi bi-cursor"></i></button>
    </form>
  </div>
</div>



 


<section class="bg-gradient-to-r from-[#062441] via-[#0b1421] to-[#0b1421] py-6 px-4 rounded-xl max-w-full shadow-2xl">
  <h2 class="text-[#0bffffcc] text-3xl font-extrabold mb-6 text-center drop-shadow-md">Ù…Ø­ØµÙˆÙ„Ø§Øª Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</h2>

<div class="overflow-x-auto whitespace-nowrap no-scrollbar py-2 mx-5 align-items-center" dir="ltr">
  <div class="inline-flex space-x-2 mx-auto">
    <button data-filter="all" class="filter-btn bg-[#0bffffcc] text-[#0b1421] border border-[#0b1421] px-5 py-2 rounded-3xl font-extrabold">Ù‡Ù…Ù‡</button>
      <button data-filter="similar-products" class="filter-btn bg-[#0bffffcc] text-[#0b1421] border border-[#0b1421] px-5 py-2 rounded-3xl font-bold">Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø´Ø§Ø¨Ù‡</button>
      <button data-filter="similar-products" class="filter-btn bg-[#0bffffcc] text-[#0b1421] border border-[#0b1421] px-5 py-2 rounded-3xl font-bold">Ø±Ù†Ú¯ Ù…Ø´Ø§Ø¨Ù‡</button>
      <button data-filter="brand-similar" class="filter-btn bg-[#0bffffcc] text-[#0b1421] border border-[#0b1421] px-5 py-2 rounded-3xl font-bold">Ø¨Ø±Ù†Ø¯ Ù…Ø´Ø§Ø¨Ù‡</button>
  </div>
</div>

<div class="space-y-6 grid grid-cols-1 md:grid-cols-2 gap-3" id="products-container">
  {% for i in get_related_products %}
    <div class="product-card bg-gradient-to-r from-[#062441] via-[#0b1421] to-[#0b1421] rounded-2xl shadow-2xl border-2 border-[#0bffff33] flex flex-row group hover:border-[#0bffffcc] transition-all duration-500 hover:shadow-2xl hover:shadow-[#0bffffcc]/20"
          data-category="similar-products"
          role="region"
          aria-label="Ú©Ø§Ø±Øª Ù…Ø­ØµÙˆÙ„">
      
      <!-- Ø¨Ø®Ø´ ØªØµÙˆÛŒØ± (Ø³Ù…Øª Ø±Ø§Ø³Øª) -->
      <div class="w-2/5 relative h-48 overflow-hidden rounded-l-2xl">
        <img
          src="{{ i.image.url }}"
          alt="{{ i.name }}"
          class="w-full h-48 object-cover transform transition-transform duration-700 group-hover:scale-105"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-[#0bffff33] to-transparent opacity-30 pointer-events-none"></div>
        
        <!-- Ø¨Ø±Ú†Ø³Ø¨ ÙˆØ¶Ø¹ÛŒØª -->
        <div class="absolute top-3 left-3 bg-[#0bffffcc] text-[#0b1421] text-xs px-3 py-1 rounded-full font-bold shadow-lg">
          {% if forloop.first %}Ø¬Ø¯ÛŒØ¯{% elif forloop.counter == 2 %}ØªØ®ÙÛŒÙ{% else %}ÙˆÛŒÚ˜Ù‡{% endif %}
        </div>
      </div>

      <!-- Ø¨Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª (Ø³Ù…Øª Ú†Ù¾) -->
      <div class="w-3/5 p-6 flex flex-col justify-between text-white">
        <div>
          <h3 class="text-2xl font-extrabold mb-3 drop-shadow-lg group-hover:text-[#0bffffcc] transition-colors duration-300">
            {{ i.name }}
          </h3>
          <p class="text-[#b0bfd1] leading-relaxed text-base mb-4 line-clamp-3">
            {{ i.description_ }}
          </p>
        </div>
        
        <div class="flex items-center justify-between">
          <div class="text-right">
            {% if i.sell_price %}
              <div class="flex items-center gap-2">
                <span class="text-[#0bffffcc] text-sm md:text-2xl font-bold">{{ i.sell_price|intcomma  }}</span>
                <span class="text-red-400 text-base line-through">{{ i.price|intcomma  }}</span>
              </div>
              <span class="text-[#b0bfd1] text-sm">ØªÙˆÙ…Ø§Ù†</span>
            {% else %}
              <span class="text-[#0bffffcc] text-sm md:text-2xl font-bold">{{ i.price|intcomma  }}</span>
              <span class="text-[#b0bfd1] text-sm mr-2">ØªÙˆÙ…Ø§Ù†</span>
            {% endif %}
          </div>
            <a
              class="bg-[#0bffffcc] hover:bg-[#0bffff] text-[#0b1421] transition-all duration-300 font-bold md:px-6 px-3 md:py-3 py-1 rounded-xl shadow-lg md:text-xl text-sm text-center hover:scale-105 active:scale-95"
              href="{% url 'product_detail' i.id i.slug %}">
              Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª
            </a>
        </div>
      </div>
    </div>
  {% endfor %}
  
  {% for i in related_color %}
    <div class="product-card bg-gradient-to-r from-[#062441] via-[#0b1421] to-[#0b1421] rounded-2xl shadow-2xl border-2 border-[#0bffff33] flex flex-row group hover:border-[#0bffffcc] transition-all duration-500 hover:shadow-2xl hover:shadow-[#0bffffcc]/20"
          data-category="color-similar"
          role="region"
          aria-label="Ú©Ø§Ø±Øª Ù…Ø­ØµÙˆÙ„">
      
      <!-- Ø¨Ø®Ø´ ØªØµÙˆÛŒØ± (Ø³Ù…Øª Ø±Ø§Ø³Øª) -->
      <div class="w-2/5 relative h-48 overflow-hidden rounded-l-2xl">
        <img
          src="{{ i.image.url }}"
          alt="{{ i.name }}"
          class="w-full h-48 object-cover transform transition-transform duration-700 group-hover:scale-105"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-[#0bffff33] to-transparent opacity-30 pointer-events-none"></div>
        
        <!-- Ø¨Ø±Ú†Ø³Ø¨ ÙˆØ¶Ø¹ÛŒØª -->
        <div class="absolute top-3 left-3 bg-[#0bffffcc] text-[#0b1421] text-xs px-3 py-1 rounded-full font-bold shadow-lg">
          {% if forloop.first %}Ø¬Ø¯ÛŒØ¯{% elif forloop.counter == 2 %}ØªØ®ÙÛŒÙ{% else %}ÙˆÛŒÚ˜Ù‡{% endif %}
        </div>
      </div>

      <!-- Ø¨Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª (Ø³Ù…Øª Ú†Ù¾) -->
      <div class="w-3/5 p-6 flex flex-col justify-between text-white">
        <div>
          <h3 class="text-2xl font-extrabold mb-3 drop-shadow-lg group-hover:text-[#0bffffcc] transition-colors duration-300">
            {{ i.name }}
          </h3>
          <p class="text-[#b0bfd1] leading-relaxed text-base mb-4 line-clamp-3">
            {{ i.description_ }}
          </p>
        </div>
        
        <div class="flex items-center justify-between">
            <div class="text-right">
              {% if i.sell_price %}
                <div class="flex items-center gap-2">
                  <span class="text-[#0bffffcc] text-sm md:text-2xl font-bold">{{ i.sell_price|intcomma  }}</span>
                  <span class="text-red-400 text-base line-through">{{ i.price|intcomma  }}</span>
                </div>
                <span class="text-[#b0bfd1] text-sm">ØªÙˆÙ…Ø§Ù†</span>
              {% else %}
                <span class="text-[#0bffffcc] text-sm md:text-2xl font-bold">{{ i.price|intcomma  }}</span>
                <span class="text-[#b0bfd1] text-sm mr-2">ØªÙˆÙ…Ø§Ù†</span>
              {% endif %}
            </div>
            <a
              class="bg-[#0bffffcc] hover:bg-[#0bffff] text-[#0b1421] transition-all duration-300 font-bold md:px-6 px-3 md:py-3 py-1 rounded-xl shadow-lg md:text-xl text-sm text-center hover:scale-105 active:scale-95"
              href="{% url 'product_detail' i.id i.slug %}">
              Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª
            </a>
        </div>
      </div>
    </div>
  {% endfor %}
  {% for i in related_brand %}
    <div class="product-card bg-gradient-to-r from-[#062441] via-[#0b1421] to-[#0b1421] rounded-2xl shadow-2xl border-2 border-[#0bffff33] flex flex-row group hover:border-[#0bffffcc] transition-all duration-500 hover:shadow-2xl hover:shadow-[#0bffffcc]/20"
          data-category="brand-similar"
          role="region"
          aria-label="Ú©Ø§Ø±Øª Ù…Ø­ØµÙˆÙ„">
      
      <!-- Ø¨Ø®Ø´ ØªØµÙˆÛŒØ± (Ø³Ù…Øª Ø±Ø§Ø³Øª) -->
      <div class="w-2/5 relative h-48 overflow-hidden rounded-l-2xl">
        <img
          src="{{ i.image.url }}"
          alt="{{ i.name }}"
          class="w-full h-48 object-cover transform transition-transform duration-700 group-hover:scale-105"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-[#0bffff33] to-transparent opacity-30 pointer-events-none"></div>
        
        <!-- Ø¨Ø±Ú†Ø³Ø¨ ÙˆØ¶Ø¹ÛŒØª -->
        <div class="absolute top-3 left-3 bg-[#0bffffcc] text-[#0b1421] text-xs px-3 py-1 rounded-full font-bold shadow-lg">
          {% if forloop.first %}Ø¬Ø¯ÛŒØ¯{% elif forloop.counter == 2 %}ØªØ®ÙÛŒÙ{% else %}ÙˆÛŒÚ˜Ù‡{% endif %}
        </div>
      </div>

      <!-- Ø¨Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª (Ø³Ù…Øª Ú†Ù¾) -->
      <div class="w-3/5 p-6 flex flex-col justify-between text-white">
        <div>
          <h3 class="text-2xl font-extrabold mb-3 drop-shadow-lg group-hover:text-[#0bffffcc] transition-colors duration-300">
            {{ i.name }}
          </h3>
          <p class="text-[#b0bfd1] leading-relaxed text-base mb-4 line-clamp-3">
            {{ i.description_ }}
          </p>
        </div>
        
        <div class="flex items-center justify-between">
            <div class="text-right">
              {% if i.sell_price %}
                <div class="flex items-center gap-2">
                  <span class="text-[#0bffffcc] text-sm md:text-2xl font-bold">{{ i.sell_price|intcomma  }}</span>
                  <span class="text-red-400 text-base line-through">{{ i.price|intcomma  }}</span>
                </div>
                <span class="text-[#b0bfd1] text-sm">ØªÙˆÙ…Ø§Ù†</span>
              {% else %}
                <span class="text-[#0bffffcc] text-sm md:text-2xl font-bold">{{ i.price|intcomma  }}</span>
                <span class="text-[#b0bfd1] text-sm mr-2">ØªÙˆÙ…Ø§Ù†</span>
              {% endif %}
            </div>
            <a
              class="bg-[#0bffffcc] hover:bg-[#0bffff] text-[#0b1421] transition-all duration-300 font-bold md:px-6 px-3 md:py-3 py-1 rounded-xl shadow-lg md:text-xl text-sm text-center hover:scale-105 active:scale-95"
              href="{% url 'product_detail' i.id i.slug %}">
              Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª
            </a>
        </div>
      </div>
    </div>
  {% endfor %}
</div>


</section>


<style>
.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.product-card {
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease forwards;
}

.product-card:nth-child(1) { animation-delay: 0.1s; }
.product-card:nth-child(2) { animation-delay: 0.2s; }
.product-card:nth-child(3) { animation-delay: 0.3s; }
.product-card:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>



<button id="toggleButton" class="text-[#0bffffcc] border border-[#0bffffcc]" aria-expanded="false" aria-controls="slidePanel" title="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ù†Ù„">
    <i class="bi bi-list-ul text-[#0bffffcc]"></i>
  </button> <br><br>
  
  <div id="slidePanel" role="region" aria-hidden="true">
    <div class="flex flex-row buttons-row gap-4 w-full">
      <form class="w-full border border-[#0bffffcc] py-2 px-4 text-center rounded-xl">
          <button onclick="openQuestionModal()" type="button" class="text-[#0bffffcc] sm:text-lg text-sm">Ø§ÙØ²ÙˆØ¯Ù† Ø³ÙˆØ§Ù„<i class="bi bi-chat-left-dots text-[#0bffffcc]"></i></button>
      </form>
 
      <form action="{% url 'com:add_to_compare' product.id %}" class="w-full border border-[#0bffffcc] py-2 px-4 text-center rounded-xl">
          <button class="text-[#0bffffcc] sm:text-lg text-sm">Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ù…Ù‚Ø§ÛŒØ³Ù‡ <i class="bi bi-grid-1x2"></i></button>
      </form>
      <form action="{% url 'watchlist:watchlist_add' %}" method="POST" class="w-full border border-[#0bffffcc] py-2 px-4 text-center rounded-xl">
        {% csrf_token %}
        <input type="text" name="id" value="{{ product.id }}" hidden class="hidden">
        <input type="text" name="url" hidden class="hidden" value="/product/{{product.id}}/{{ product.slug }}/">
         <button class="text-[#0bffffcc] sm:text-lg text-sm">Ø§ÙØ²ÙˆØ¯Ù† ÙˆØ§Ú† Ù„ÛŒØ³Øª <i class="bi bi-bell text-[#0bffffcc]"></i></button>
      </form>
    </div>
  </div>

  


<style>
  #prevBtn, #nextBtn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 3.5rem; /* Ø¨Ø²Ø±Ú¯ØªØ± */
  color: #0bffff;
  background-color: rgba(0, 0, 0, 0.5); /* Ø²Ù…ÛŒÙ†Ù‡ Ù†ÛŒÙ…Ù‡ Ø´ÙØ§Ù */
  border: none;
  border-radius: 50%;
  width: 3.5rem;
  height: 3.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.3s, color 0.3s;
  z-index: 10000;
  user-select: none;
}

#prevBtn:hover, #nextBtn:hover {
background-color: #0bffff;
color: #000;
}

#prevBtn {
left: 1rem;
}

#nextBtn {
right: 1rem;
}

</style>

  
  
   
<script>
  const toggleButton = document.getElementById('toggleButton');
  const slidePanel = document.getElementById('slidePanel');

  toggleButton.addEventListener('click', () => {
    const isOpen = slidePanel.classList.toggle('open');
    slidePanel.setAttribute('aria-hidden', !isOpen);
    toggleButton.setAttribute('aria-expanded', isOpen);
  });
</script>

  
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const videoCards = document.querySelectorAll("[data-video-url]");
    const videoModal = document.getElementById("video-modal");
    const videoPlayer = document.getElementById("video-player");
    const closeModalBtn = document.getElementById("close-modal");

    // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„
    videoCards.forEach((card) => {
      card.addEventListener("click", function () {
        const videoUrl = this.getAttribute("data-video-url");
        videoPlayer.src = videoUrl;
        videoModal.classList.remove("hidden");
        videoPlayer.play();
      });
    });

    // Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§ Ø¯Ú©Ù…Ù‡ Ã—
    closeModalBtn.addEventListener("click", function () {
      closeVideoModal();
    });

    // Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø¨ÛŒØ±ÙˆÙ† Ø§Ø² Ù…ÙˆØ¯Ø§Ù„
    videoModal.addEventListener("click", function (e) {
      if (e.target === videoModal) {
        closeVideoModal();
      }
    });

    function closeVideoModal() {
      videoModal.classList.add("hidden");
      videoPlayer.pause();
      videoPlayer.currentTime = 0;
      videoPlayer.src = "";
    }
  });
</script>

  

<script>
window.addEventListener('DOMContentLoaded', function () {
const modal = document.getElementById("galleryModal");
const closeBtn = document.getElementById("closeModalBtn");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const modalImage = document.getElementById("modalImage");
const modalCaption = document.getElementById("modalCaption");

// Ø¢Ø±Ø§ÛŒÙ‡ ØªØµØ§ÙˆÛŒØ± Ùˆ Ú©Ù¾Ø´Ù† (Ø¨Ø§ÛŒØ¯ Ø§ÛŒÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ùˆ Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø¨Ø³Ø§Ø²ÛŒ ÛŒØ§ Ø§Ø² Ø¯ÛŒØªØ§ Ø¨Ú¯ÛŒØ±ÛŒ)
// Ú†ÙˆÙ† ØªÙˆ Ú©Ø¯ Ø®ÙˆØ¯Øª Ø¯Ø§Ø±ÛŒ Ø§Ø² Django template Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØŒ Ù…ÛŒØªÙˆÙ†ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ø¯Ø§Ø¯Ù‡ Ø±Ùˆ Ø¨ÙØ±Ø³ØªÛŒ Ø¨Ù‡ js
const galleryImages = [
  {% for image in gallery %}
    { src: "{{ image.image.url }}", caption: "ØªÙˆØ¶ÛŒØ­ ØªØµÙˆÛŒØ± {{ forloop.counter }}" }{% if not forloop.last %},{% endif %}
  {% endfor %}
];

let currentIndex = 0;

window.openModal = function(src, caption) {
  // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ†Ø¯Ú©Ø³ ØªØµÙˆÛŒØ± Ø¨Ø§Ø² Ø´Ø¯Ù‡
  currentIndex = galleryImages.findIndex(img => img.src === src);
  updateModal();
  modal.classList.remove("hidden");
  modal.classList.add("flex");
};

function updateModal() {
  modalImage.src = galleryImages[currentIndex].src;
  // modalCaption.textContent = galleryImages[currentIndex].caption;
}

function closeModal() {
  modal.classList.remove("flex");
  modal.classList.add("hidden");
  modalImage.src = "";
}

closeBtn.addEventListener('click', closeModal);

document.addEventListener('keydown', function (e) {
  if (e.key === "Escape") {
    closeModal();
  } else if (e.key === "ArrowRight") {
    nextImage();
  } else if (e.key === "ArrowLeft") {
    prevImage();
  }
});

modal.addEventListener('click', function (e) {
  if (e.target === modal) {
    closeModal();
  }
});

function nextImage() {
  currentIndex = (currentIndex + 1) % galleryImages.length;
  updateModal();
}

function prevImage() {
  currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
  updateModal();
}

nextBtn.addEventListener('click', function (e) {
  e.stopPropagation();
  nextImage();
});

prevBtn.addEventListener('click', function (e) {
  e.stopPropagation();
  prevImage();
});
});

</script>  

<script>
  function shareProduct() {
    if (navigator.share) {
      navigator.share({
        title: document.title,
        url: window.location.href
      });
    } else {
      alert('Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
    }
  }
</script>

<script>
  const stars = document.querySelectorAll('#star-container i');
  const ratingInput = document.getElementById('rating-input');
  let selectedRating = 0;

  stars.forEach((star, idx) => {
    // Ù‡Ù†Ú¯Ø§Ù… Ú©Ù„ÛŒÚ©
    star.addEventListener('click', () => {
      selectedRating = idx + 1;
      ratingInput.value = selectedRating;
      updateStars();
    });

    // Ù‡Ù†Ú¯Ø§Ù… Ù‡Ø§ÙˆØ±
    star.addEventListener('mouseover', () => {
      updateStars(idx + 1);
    });

    // Ù‡Ù†Ú¯Ø§Ù… Ø®Ø§Ø±Ø¬ Ø´Ø¯Ù† Ø§Ø² Ù‡Ø§ÙˆØ±
    star.addEventListener('mouseout', () => {
      updateStars();
    });
  });

  function updateStars(hoverRating = selectedRating) {
    stars.forEach((star, idx) => {
      if (idx < hoverRating) {
        star.classList.remove('text-gray-300');
        star.classList.add('text-yellow-400');
      } else {
        star.classList.remove('text-yellow-400');
        star.classList.add('text-gray-300');
      }
    });
  }
</script>  





<script>
  // Ú¯Ø±ÙØªÙ† Ø¯Ú©Ù…Ù‡ Ù‡Ø§ Ùˆ Ú©Ø§Ù†ØªÛŒÙ†Ø± Ù…Ø­ØµÙˆÙ„Ø§Øª
  const filterButtons = document.querySelectorAll('.filter-btn');
  const productsContainer = document.getElementById('products-container');
  const products = productsContainer.querySelectorAll('.product-card');

  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
      const filter = button.getAttribute('data-filter');

      // Ø§Ú¯Ø± "Ù‡Ù…Ù‡" Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯ Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯
      if (filter === 'all') {
        products.forEach(product => {
          product.style.display = 'flex'; // Ú†ÙˆÙ† ÙÙ„Ú©Ø³ Ø§Ø³Øª
        });
      } else {
        products.forEach(product => {
          if (product.getAttribute('data-category') === filter) {
            product.style.display = 'flex';
          } else {
            product.style.display = 'none';
          }
        });
      }

      // ØªØºÛŒÛŒØ± Ø§Ø³ØªØ§ÛŒÙ„ Ø¯Ú©Ù…Ù‡ ÙØ¹Ø§Ù„
      filterButtons.forEach(btn => btn.classList.remove('ring', 'ring-cyan-500'));
      button.classList.add('ring', 'ring-cyan-500');
    });
  });
</script>

<script>
  function openQuestionModal() {
    document.getElementById('questionModal').classList.remove('hidden');
  }

  function closeQuestionModal() {
    document.getElementById('questionModal').classList.add('hidden');
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', function () {
  const productModal = document.getElementById("productModal");
  const closeBtn = document.getElementById("closeProductModalBtn");
  const prevBtn = document.getElementById("prevProductBtn");
  const nextBtn = document.getElementById("nextProductBtn");
  const modalImage = document.getElementById("productModalImage");

  // Ø¢Ø±Ø§ÛŒÙ‡ Ø¹Ú©Ø³â€ŒÙ‡Ø§ - Ø¹Ú©Ø³ Ø§ØµÙ„ÛŒ + Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ
  const productImages = [
    "{{ product.image.url }}",
    {% for i in gallery %}
        "{{ i.image.url }}"{% if not forloop.last %},{% endif %}
    {% endfor %}
  ];

  let currentIndex = 0;

  window.openProductModal = function(index) {
    currentIndex = index;
    updateModalImage();
    productModal.classList.remove("hidden");
    productModal.classList.add("flex");
  };

  function updateModalImage() {
    modalImage.src = productImages[currentIndex];
  }

  function closeModal() {
    productModal.classList.remove("flex");
    productModal.classList.add("hidden");
    modalImage.src = "";
  }

  closeBtn.addEventListener('click', closeModal);

  prevBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    currentIndex = (currentIndex - 1 + productImages.length) % productImages.length;
    updateModalImage();
  });

  nextBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    currentIndex = (currentIndex + 1) % productImages.length;
    updateModalImage();
  });

  document.addEventListener('keydown', function(e) {
    if (!productModal.classList.contains("flex")) return;
    if (e.key === "Escape") closeModal();
    else if (e.key === "ArrowRight") {
      currentIndex = (currentIndex + 1) % productImages.length;
      updateModalImage();
    } else if (e.key === "ArrowLeft") {
      currentIndex = (currentIndex - 1 + productImages.length) % productImages.length;
      updateModalImage();
    }
  });

  productModal.addEventListener('click', function(e) {
    if (e.target === productModal) closeModal();
  });
});

</script>
 




<script>
  function toggleAccordion(id) {
    const content = document.getElementById(id);
    const icon = document.getElementById('icon-' + id);
    if (content.classList.contains('hidden')) {
      content.classList.remove('hidden');
      icon.classList.remove('bi-chevron-down');
      icon.classList.add('bi-chevron-up');
    } else {
      content.classList.add('hidden');
      icon.classList.remove('bi-chevron-up');
      icon.classList.add('bi-chevron-down');
    }
  }
</script>



{% if cart %}
  
<!-- remove from cart -->
<script>
function cartRemove() {
  {% for i in cart %}
    {% if product.id == i.product.id %}
        const productId = {{ i.id }}
    {% endif %}
  {% endfor %}
  
      fetch("/cart/mines/", {
        method: 'POST',
        headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: `id=${productId}`
      })
      .then(res => res.json())
      .then(data => {
          if (data.success) {
  
            document.getElementById('productQuantity').innerText = data.qty_mines
          } else if (data.error) {
  
          }
        });
 }
</script>
<!-- Ø­Ø°Ù Ø§Ø² Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ -->
<!--Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ -->
<script>
function cartAdd(params) {
    {% for i in cart %}
      {% if product.id == i.product.id %}
          const productId = {{ i.id }}
      {% endif %}
    {% endfor %}
      fetch("/cart/plus/", {
        method: 'POST',
        headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: `id=${productId}`
      })
      .then(res => res.json())
        .then(data => {
          if (data.success) {
 
            document.getElementById('productQuantity').innerText = data.qty_add
 
          } else if (data.error) {
  
          }
        });
}</script>
{% endif %} 

<script>
  function likeProduct(productId) {
  fetch(`/ajax/product-like/${productId}/`)
    .then(res => res.json())
    .then(data => {
      const Like = data.like_status;
      if (Like == 'LIKE'){
        const btn = document.getElementById('like_btn');
        btn.innerHTML = '<i class="bi bi-heart-fill"></i> '
        const likeCount = document.getElementById('like_count');
        likeCount.innerText = data.like_count

      }
      if (Like == 'DISLIKE'){
        const btn = document.getElementById('like_btn');
        btn.innerHTML = '<i class="bi bi-heart"></i> '
        const likeCount = document.getElementById('like_count');
        likeCount.innerText = data.like_count

      }
      document.getElementById('cart_qty').innerText = Like
      });      
  }
  likeProduct()

</script>
 
 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/moment"></script>
 <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment"></script>
{% endblock %}